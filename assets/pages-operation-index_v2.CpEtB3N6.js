import{s as a,N as n,n as o,b as t,O as i,c as s,q as e,e as c,w as r,F as _,o as p,u as m,C as d,d as l,f as u,t as f,g as h,j as g,k as v,i as k}from"./index-MIvYX1nW.js";import{_ as j,c as x}from"./cc-grid-item.Cs-_UddG.js";import{r as w}from"./uni-app.es.B8zr0lZI.js";import{_ as b}from"./uni-data-picker.7TlEDIWg.js";import{_ as y,a as $}from"./uni-forms.C-YkALHf.js";import{_ as F,a as C}from"./uni-popup.j9WTBudP.js";import{l as I,p as S}from"./index.DbF5UMRK.js";import"./k3cloudapi.DzDu3BGl.js";import{S as N}from"./stock_loc.BckAHwoS.js";import"./inv_log.BJcJnepW.js";import{s as V}from"./scan_code.bSbj3X8t.js";import{_ as q}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-load-more.5aGCwx5G.js";import"./uni-icons.DEYikQDp.js";const B=q({components:{ccGrid:j,ccGridItem:x},data(){return{navs:[{name:"入库计划",permission:["wh_admin","nrj_admin"],icon_path:"/static/icon/nav_stock_in.png",action:()=>{I("/pages/operation/inbound/v2/index")}},{name:"出库计划",permission:["wh_admin"],icon_path:"/static/icon/nav_stock_out.png",action:()=>{I("/pages/operation/outbound/v2/index")}},{name:"库内调拨",permission:["nrj_admin"],icon_path:"/static/icon/nav_scan_move.png",action:()=>{I("/pages/operation/move/unpack")}},{name:"出库",permission:["nrj_admin"],icon_path:"/static/icon/nav_scan_out.png",action:()=>{I("/pages/operation/outbound/unpack")}},{name:"入库扫码",permission:["nrj_admin"],icon_path:"/static/icon/nav_scan_in_warn.png",action:()=>{I("/pages/operation/inbound/v1/easy")}},{name:"库存调整",permission:["wh_admin","nrj_admin"],icon_path:"/static/icon/nav_stock_move.png",action:()=>{I("/pages/operation/move/v2/index")}},{name:"库存查询",permission:["wh_admin","wh_staff","nrj_admin"],icon_path:"/static/icon/nav_scan.png",action:()=>{this.inv_search()}},{name:"库存总览",permission:["default","wh_admin","nrj_admin"],icon_path:"/static/icon/nav_stock.png",action:()=>{I("/pages/operation/manage/invs")}},{name:"库位管理",permission:["wh_admin","nrj_admin"],icon_path:"/static/icon/nav_stock_loc.png",action:()=>{I("/pages/operation/manage/locs")}},{name:"物料查询",permission:["default","wh_admin","wh_staff","nrj_admin","guest"],icon_path:"/static/icon/nav_stock_search.png",action:()=>{I("/pages/operation/material/search")}},{name:"出库查询",permission:["default"],icon_path:"/static/icon/nav_truck.png",action:()=>{I("/pages/operation/outbound/v2/search")}},{name:"列表",permission:["wh_admin","nrj_admin"],icon_path:"/static/icon/nav_list_search.png",action:()=>{I("/pages/operation/list/index")}},{name:"统计",permission:["wh_admin","nrj_admin"],icon_path:"/static/icon/nav_chart.png",action:()=>{I("/pages/operation/statistics/index")}},{name:"标签打印",permission:["nrj_admin"],icon_path:"/static/icon/nav_printer.png",action:()=>{I("/pages/operation/print/index")}}],nav_form:{stock_id:a.state.cur_stock.FStockId,bd_stock_opts:a.state.bd_stock_opts},nav_form_rules:{stock_id:{rules:[{required:!0,errorMessage:"请选择仓库"}]}}}},onReady(){setTimeout((o=>{n({title:a.state.cur_stock.FName})}),100)},onNavigationBarButtonTap(n){if(0===n.index){console.log("this.$data",this.$data);let n=[];for(let o of a.state.bd_stock_opts)n.push({...o,disable:o.value!=a.state.cur_stock.FUseOrgId});this.nav_form.bd_stock_opts=n,this.$refs.nav_dialog.open()}},methods:{inv_search(){V().then((a=>{o({url:`/pages/operation/manage/inv_search?t=${a.result}`})})).catch((a=>{t({icon:"none",title:a})}))},nav_dialog_close(){this.$refs.nav_dialog.close()},nav_dialog_confirm(){this.$refs.nav_form.validate().then((o=>{let i=a.state.bd_stocks.find((a=>a.FStockId===this.nav_form.stock_id));a.commit("set_cur_stock",i),n({title:a.state.cur_stock.FName}),N.query({FStockId:a.state.cur_stock.FStockId}).then((n=>{a.commit("set_stock_locs",n.data),t({title:"已切换仓库"}),S("success")})),this.$refs.nav_dialog.close()})).catch((a=>{}))}}},[["render",function(a,n,o,t,x,I){const S=g,N=v,V=k,q=i("cc-grid-item"),B=w(s("cc-grid"),j),G=w(s("uni-data-picker"),b),T=w(s("uni-forms-item"),y),W=w(s("uni-forms"),$),M=w(s("uni-popup-dialog"),F),O=w(s("uni-popup"),C);return p(),e(_,null,[c(B,null,{default:r((()=>[(p(!0),e(_,null,m(x.navs,((n,o)=>(p(),e(_,{key:o},["su"==a.$store.state.role||n.permission.includes(a.$store.state.role)||n.permission.includes("all")&&"guest"!=a.$store.state.role?(p(),l(q,{key:0,onClick:n.action},{default:r((()=>[c(V,{class:"grid-item-box"},{default:r((()=>[c(S,{src:n.icon_path,mode:"widthFix",class:"grid-item-icon"},null,8,["src"]),c(N,{class:"grid-item-text"},{default:r((()=>[u(f(n.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])):h("",!0)],64)))),128))])),_:1}),c(O,{ref:"nav_dialog",type:"dialog",style:{"z-index":"1000"}},{default:r((()=>[c(M,{type:"error",title:"切换仓库",cancelText:"关闭",onClose:I.nav_dialog_close,onConfirm:I.nav_dialog_confirm,"before-close":!0,style:d({width:a.$store.state.system_info.windowWidth-20+"px",minWidth:"360px",maxWidth:"1200px"})},{default:r((()=>[c(W,{ref:"nav_form",model:x.nav_form,rules:x.nav_form_rules,style:{width:"100%"}},{default:r((()=>[c(T,{label:"仓库",name:"stock_id"},{default:r((()=>[c(G,{ref:"stock_id_picker",modelValue:x.nav_form.stock_id,"onUpdate:modelValue":n[0]||(n[0]=a=>x.nav_form.stock_id=a),localdata:x.nav_form.bd_stock_opts,"popup-title":"请选择所属仓库"},null,8,["modelValue","localdata"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["onClose","onConfirm","style"])])),_:1},512)],64)}],["__scopeId","data-v-0b9fc97a"]]);export{B as default};
