import{s as e,b as t,a,h as o,c as l,q as i,e as s,w as r,d as m,g as n,F as _,i as d,o as u,f as c,t as f,u as p,S as h,l as v,k as y,T as F}from"./index-DsK9pIyj.js";import{_ as b}from"./uni-easyinput.BfazFYzq.js";import{r as k}from"./uni-app.es.CSK8ITuj.js";import{_ as g,a as w}from"./uni-forms.DoSYlyoS.js";import{_ as N}from"./uni-data-select.DcISTJAW.js";import{_ as S}from"./uni-icons.DRoE6XYp.js";import{_ as q}from"./uni-section.BpQrEx4g.js";import{_ as I}from"./uni-list-item.BkmqxiQh.js";import{_ as x}from"./uni-list.dJf-6p1_.js";import{_ as V,a as C}from"./uni-swipe-action.BTWqdF-e.js";import{_ as j}from"./uni-load-more.CyJx3ZKG.js";import{_ as B}from"./uni-goods-nav.BN-nj5na.js";import{_ as L}from"./uni-drawer.BPNIP2eu.js";import{_ as O}from"./uni-data-checkbox.y8E7Mp8x.js";import{_ as T,a as $}from"./uni-row.CMhOpWuA.js";import{_ as Q}from"./uni-data-picker.MxVuyZ-u.js";import{_ as U}from"./uni-number-box.DOITgqEr.js";import{_ as M}from"./uni-datetime-picker.Bsu03if5.js";import{_ as R}from"./uni-tag.DapJ5B6u.js";import{_ as z,a as A}from"./uni-popup.CPWlX1tX.js";import{K as D}from"./k3cloudapi.PCDjx1SF.js";import{p as E}from"./index.uHoH2c2-.js";import{a as Y}from"./index.DEl4oXeA.js";import{B as K}from"./bd_material.d9K6JZK2.js";import{a as P,I as W}from"./stock_loc.Bj3C3Byx.js";import"./inv_log.D0BShjlW.js";import{s as G}from"./scan_code.CGa79-3n.js";import{_ as H}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-badge.CO78OwkC.js";import"./bd_empinfo.DSF0B_p6.js";const J=H({props:{material_no:{type:String}},data(){return{edit_mode:"edit",invs:[],inv_plans:[],material_categories:[],material:{material_no:"",material_name:"",material_spec:"",base_unit_name:"",material_image:""},search_form:{no:"",material_no:"",material_name:"",material_spec:"",material_category_id:"",candidates:[]},remark_presets:["未归位","数量不对","退库"],move_dialog:{confirm_text:"新增"},move_form:{type:"edit",inv:{},dest_loc_no:"",op_qty:0,edit_qty:0,new_loc_no:"",new_batch_no:"",new_qty:0,remark:"",bill_no:""},move_form_rules:{dest_loc_no:{rules:[{required:!0,errorMessage:"库位号不能为空"},{validateFunction:(e,t,a,o)=>t==this.move_form.inv["FStockLocId.FNumber"]?o("库位号不能相同"):this._exist_inv_plan()?o("目标库存号已有计划"):void 0}]},new_loc_no:{rules:[{required:!0,errorMessage:"库位号不能为空"}]},new_batch_no:{rules:[{required:!0,errorMessage:"批次号不能为空"},{validateFunction:(e,t,a,o)=>{if(this.invs.find((e=>e["FStockLocId.FNumber"]==this.move_form.new_loc_no&&e.FBatchNo==this.move_form.new_batch_no.replace(/-/g,""))))return o("相同库位相同批次库存已存在")}}]},op_qty:{rules:[{validateFunction:(e,t,a,o)=>t<=0&&"move"==this.move_form.type?o("移库数量必须大于0"):t>this.move_form.inv.FQty-this.move_form.inv.planned_qty?o("调整总数超过上限"):void 0}]},edit_qty:{rules:[{validateFunction:(e,t,a,o)=>{if(t===this.move_form.inv.FQty-this.move_form.inv.planned_qty)return o("库存数量没有变化")}}]},new_qty:{rules:[{validateFunction:(e,t,a,o)=>{if(t<=0)return o("新增数量必须大于0")}}]},remark:{rules:[{required:!0,errorMessage:"调整原因不能为空"}]}},swipe_options:[{text:"删除",style:{backgroundColor:"#dd524d"}}],goods_nav:{options:[{icon:"cart",text:"计划",info:0}],button_group:[{text:"扫码查询",backgroundColor:e.state.goods_nav_color.red,color:"#fff"}]}}},onLoad(e){e.material_no&&(this.search_form.material_no=e.material_no,this.search())},mounted(){this.load_bd_materialcategories()},methods:{swipe_action_click(e,t){0===e.index&&this.submit_delete(t)},goods_nav_click(e){0===e.index&&this.$logger.info("this.$data",this.$data)},goods_nav_button_click(e){0===e.index&&this.scan_code()},searchbar_icon_click(e){"prefix"==e&&this.scan_code()},scan_code(){G().then((e=>{this.search_form.no=e.result,e.result.includes("||")&&(this.search_form.no=e.result.split("||")[1]),this.search()})).catch((e=>{t({icon:"none",title:e})}))},open_move_dialog(e){e?(this.edit_mode="edit",this.move_form.inv=e,this.move_form.edit_qty=e.FQty-e.planned_qty):(this.edit_mode="new",this.move_form.type="new"),this.$refs.move_dialog.open()},close_move_dialog(){this.$refs.move_dialog.close(),this.move_form={type:"edit",inv:{},dest_loc_no:"",op_qty:0,edit_qty:0,new_loc_no:"",new_batch_no:"",new_qty:0,remark:""}},auto_input_remark(e){this.move_form.remark=e},async search(){if(this._set_material(),this.invs=[],this.inv_plans=[],!this.search_form.material_no&&!this.search_form.material_name&&!this.search_form.material_spec)return;let l={};e.state.cur_stock.FUseOrgId&&(l.FUseOrgId=e.state.cur_stock.FUseOrgId),this.search_form.material_no&&(l.FNumber_lk=this.search_form.material_no),this.search_form.material_name&&(l.FName_lk=this.search_form.material_name),this.search_form.material_spec&&(l.FSpecification_lk=this.search_form.material_spec),this.search_form.material_category_id&&(l.FCategoryId=this.search_form.material_category_id);a({title:"Loading",mask:!0}),K.query(l,{per_page:50,order:"FNumber ASC"}).then((e=>{var a;o(),this.search_form.candidates=e.data,e.data.length>1&&this.$refs.search_drawer.open(),1===e.data.length&&this.load_data(null==(a=e.data[0])?void 0:a.FNumber),e.data.length<1&&t({icon:"none",title:"无匹配结果"})}))},async confirm_move_dialog(){var l,i,s,r;try{await this.$refs.move_form.validate();let m=new P;if("move"==this.move_form.type)m=new P({FOpType:"mv",FStockId:e.state.cur_stock.FStockId,FStockLocNo:this.move_form.inv["FStockLocId.FNumber"],FDestStockLocNo:this.move_form.dest_loc_no,FMaterialId:this.move_form.inv.FMaterialId,FOpQTY:this.move_form.op_qty,FBatchNo:this.move_form.inv.FBatchNo,FOpStaffNo:e.state.cur_staff.FNumber,FRemark:null==(l=this.move_form.remark)?void 0:l.trim(),FBillNo:this.move_form.bill_no,FSupplierId:this.move_form.inv.FSupplierId});else if("edit"==this.move_form.type){let t=this.move_form.edit_qty-this.move_form.inv.FQty+this.move_form.inv.planned_qty;m=new P({FOpType:t>0?"add":"sub",FStockId:e.state.cur_stock.FStockId,FStockLocNo:this.move_form.inv["FStockLocId.FNumber"],FMaterialId:this.move_form.inv.FMaterialId,FOpQTY:Math.abs(t),FBatchNo:this.move_form.inv.FBatchNo,FOpStaffNo:e.state.cur_staff.FNumber,FRemark:null==(i=this.move_form.remark)?void 0:i.trim(),FBillNo:this.move_form.bill_no,FSupplierId:this.move_form.inv.FSupplierId})}else"new"==this.move_form.type&&(m=new P({FOpType:"add",FStockId:e.state.cur_stock.FStockId,FStockLocNo:this.move_form.new_loc_no,FMaterialId:this.material.material_id,FOpQTY:this.move_form.new_qty,FBatchNo:this.move_form.new_batch_no.replace(/-/g,""),FOpStaffNo:e.state.cur_staff.FNumber,FRemark:null==(s=this.move_form.remark)?void 0:s.trim(),FBillNo:this.move_form.bill_no,FSupplierId:this.move_form.inv.FSupplierId}));a({title:"Loading",mask:!0});let n=await m.save();o(),E("success"),this.close_move_dialog(),n.data.Result.ResponseStatus.IsSuccess?(await this.load_inv_plans(this.material.material_no),this._update_inv_status(),t({title:"保存成功"})):t({icon:"none",title:null==(r=n.data.Result.ResponseStatus.Errors[0])?void 0:r.Message})}catch(m){}},async load_data(e){if(!e)return this._set_material(),this.invs=[],void(this.inv_plans=[]);this.$refs.search_drawer.close(),a({title:"Loading",mask:!0});let t=await this.load_material(e);this._set_material(t),t?(await this.load_invs(e),await this.load_inv_plans(e),this._update_inv_status()):(this.invs=[],this.inv_plans=[]),o()},async load_invs(t){const a={FStockId:e.state.cur_stock.FStockId,"FMaterialId.FNumber":t,FQty_gt:0};return W.query(a,{order:"FStockLocId.FNumber ASC, FBatchNo ASC"}).then((e=>{this.invs=e.data}))},async load_inv_plans(t){const l={FStockId:e.state.cur_stock.FStockId,"FMaterialId.FNumber":t,FOpType_in:["mv","add","sub","out"],FDocumentStatu_in:["A","B"]};return a({title:"Loading",mask:!0}),P.query(l,{order:"FStockLocId.FNumber ASC, FBatchNo ASC"}).then((t=>(o(),this.inv_plans=t.data,this.inv_plans.forEach((t=>{"A"!=t.FDocumentStatu&&(t.status=e.state.document_status_dict[t.FDocumentStatu])})),t.data)))},async load_material(t){let a=this.search_form.candidates.find((e=>e.FNumber==t));if(a)return a;let o=await Y(t,e.state.cur_stock.FUseOrgId);return o.data[0]?o.data[0]:void 0},async load_bd_materialcategories(){var t;(null==(t=e.state.bd_materialcategories)?void 0:t.length)||(a({title:"Loading",mask:!0}),await K.categories().then((t=>{o(),e.commit("set_bd_materialcategories",t.data)}))),this.material_categories=e.state.bd_materialcategories.map((e=>({value:e.FMasterId,text:e.FName})))},async submit_delete(e){var l;if("A"==e.FDocumentStatu){a({title:"Loading",mask:!0});let i=await P.delete([e.FID]);o(),i.data.Result.ResponseStatus.IsSuccess?(E("delete"),this.$refs.inv_plan_swipe.closeAll(),await this.load_inv_plans(this.material.material_no),this._update_inv_status()):t({icon:"none",title:null==(l=i.data.Result.ResponseStatus.Errors[0])?void 0:l.Message})}else this.$refs.inv_plan_swipe.closeAll(),t({icon:"error",title:"只能删除新增的计划"})},_exist_inv_plan(){return this.inv_plans.find((e=>e.FBatchNo==this.move_form.inv.FBatchNo&&e["FStockLocId.FNumber"]==this.move_form.inv["FStockLocId.FNumber"]&&e["FDestStockLocId.FNumber"]==this.move_form.dest_loc_no))},_set_material(e){e?(this.material.material_id=e.FMaterialId,this.material.material_no=e.FNumber,this.material.material_name=e.FName,this.material.material_spec=e.FSpecification,this.material.base_unit_name=e["FBaseUnitId.FName"],this.material.material_image=e.FImageFileServer):(this.material.material_id="",this.material.material_no="",this.material.material_name="",this.material.material_spec="",this.material.base_unit_name="Pcs",this.material.material_image="")},_sum_planned_qty(){return this.inv_plans.map((e=>e.FOpQTY)).concat([0]).reduce(((e,t)=>e+t))},_update_inv_status(){this.invs.forEach((e=>{e.planned_qty=0,this.inv_plans.forEach((t=>{t["FStockLocId.FNumber"]==e["FStockLocId.FNumber"]&&t.FBatchNo==e.FBatchNo&&["mv","sub","out"].includes(t.FOpType)&&(e.planned_qty+=t.FOpQTY)}))}))},thumbnail_url:e=>D.thumbnail_url(e)}},[["render",function(e,t,a,o,D,E){const Y=k(l("uni-easyinput"),b),K=k(l("uni-forms-item"),g),P=k(l("uni-data-select"),N),W=k(l("uni-icons"),S),G=v,H=k(l("uni-forms"),w),J=d,X=k(l("uni-section"),q),Z=k(l("uni-list-item"),I),ee=k(l("uni-list"),x),te=y,ae=k(l("uni-swipe-action-item"),V),oe=k(l("uni-swipe-action"),C),le=k(l("uni-load-more"),j),ie=k(l("uni-goods-nav"),B),se=F,re=k(l("uni-drawer"),L),me=k(l("uni-data-checkbox"),O),ne=k(l("uni-col"),T),_e=k(l("uni-data-picker"),Q),de=k(l("uni-row"),$),ue=k(l("uni-number-box"),U),ce=k(l("uni-datetime-picker"),M),fe=k(l("uni-tag"),R),pe=k(l("uni-popup-dialog"),z),he=k(l("uni-popup"),A);return u(),i(_,null,[s(X,{title:"查询物料",type:"square"},{default:r((()=>[s(J,{class:"container"},{default:r((()=>[s(H,{ref:"form",model:D.search_form,labelWidth:"70px"},{default:r((()=>[s(K,{label:"编码",name:"material_no"},{default:r((()=>[s(Y,{modelValue:D.search_form.material_no,"onUpdate:modelValue":t[0]||(t[0]=e=>D.search_form.material_no=e),trim:"both","prefix-icon":"scan",onIconClick:E.searchbar_icon_click},null,8,["modelValue","onIconClick"])])),_:1}),s(K,{label:"名称",name:"material_name"},{default:r((()=>[s(Y,{modelValue:D.search_form.material_name,"onUpdate:modelValue":t[1]||(t[1]=e=>D.search_form.material_name=e),trim:"both"},null,8,["modelValue"])])),_:1}),s(K,{label:"规格",name:"material_spec"},{default:r((()=>[s(Y,{modelValue:D.search_form.material_spec,"onUpdate:modelValue":t[2]||(t[2]=e=>D.search_form.material_spec=e),trim:"both"},null,8,["modelValue"])])),_:1}),s(K,{label:"存货类别",name:"material_category_id"},{default:r((()=>[s(P,{modelValue:D.search_form.material_category_id,"onUpdate:modelValue":t[3]||(t[3]=e=>D.search_form.material_category_id=e),localdata:D.material_categories},null,8,["modelValue","localdata"])])),_:1}),s(G,{onClick:E.search,type:"primary"},{default:r((()=>[s(W,{type:"search",color:"#fff"}),c(" 搜索 ")])),_:1},8,["onClick"])])),_:1},8,["model"])])),_:1})])),_:1}),D.material.material_no?(u(),m(X,{key:0,title:"物料信息",type:"square"},{default:r((()=>[s(ee,null,{default:r((()=>[s(Z,{title:D.material.material_no,note:[`名称：${D.material.material_name}`,`规格：${D.material.material_spec}`].join("\n"),thumb:E.thumbnail_url(D.material.material_image),"thumb-size":"lg"},null,8,["title","note","thumb"])])),_:1})])),_:1})):n("",!0),D.inv_plans.length?(u(),m(X,{key:1,title:"当前计划明细",type:"square","sub-title":"app-plus"==e.$store.state.device_type?"左滑可删除":""},{right:r((()=>[s(J,{class:"uni-section__right"},{default:r((()=>[s(J,null,{default:r((()=>[c(" 已计划 "),s(te,{class:"sum_qty"},{default:r((()=>[c(f(E._sum_planned_qty()),1)])),_:1}),c(" "+f(D.material.base_unit_name),1)])),_:1})])),_:1})])),default:r((()=>[s(oe,{ref:"inv_plan_swipe"},{default:r((()=>[(u(!0),i(_,null,p(D.inv_plans,((t,a)=>(u(),m(ae,{key:a,threshold:60,"right-options":D.swipe_options,onClick:e=>E.swipe_action_click(e,t)},{default:r((()=>[s(Z,{disabled:"out"==t.FOpType},{body:r((()=>[s(J,{class:"uni-list-item__body"},{default:r((()=>[s(J,{class:"title"},{default:r((()=>[c(f(t["FStockLocId.FNumber"])+" ",1),"mv"==t.FOpType?(u(),i(_,{key:0},[s(W,{type:"redo",size:"20",color:"#007aff"}),c(" "+f(t["FDestStockLocId.FNumber"]),1)],64)):n("",!0)])),_:2},1024),s(J,{class:"note"},{default:r((()=>{var e,a;return[s(J,null,{default:r((()=>[c("批次："+f(t.FBatchNo),1)])),_:2},1024),s(J,null,{default:r((()=>[c("供应商： "+f(t["FSupplierId.FName"]),1)])),_:2},1024),(null==(e=t.FBillNo)?void 0:e.trim())?(u(),m(J,{key:0},{default:r((()=>[c("单据："+f(t.FBillNo),1)])),_:2},1024)):n("",!0),(null==(a=t.FRemark)?void 0:a.trim())?(u(),m(J,{key:1},{default:r((()=>[c("备注："+f(t.FRemark),1)])),_:2},1024)):n("",!0)]})),_:2},1024)])),_:2},1024)])),footer:r((()=>[s(J,{class:"uni-list-item__foot"},{default:r((()=>[s(J,null,{default:r((()=>[s(J,{class:"op_qty"},{default:r((()=>["mv"==t.FOpType?(u(),m(te,{key:0,class:"text-primary"},{default:r((()=>[c("移动 ")])),_:1})):n("",!0),"add"==t.FOpType?(u(),m(te,{key:1,class:"text-error"},{default:r((()=>[c("增加 ")])),_:1})):n("",!0),"sub"==t.FOpType?(u(),m(te,{key:2,class:"text-success"},{default:r((()=>[c("减少 ")])),_:1})):n("",!0),"out"==t.FOpType?(u(),m(te,{key:3,class:"text-success"},{default:r((()=>[c("出库 ")])),_:1})):n("",!0),s(te,null,{default:r((()=>[c(f(t.FOpQTY)+" "+f(t["FStockUnitId.FName"]),1)])),_:2},1024)])),_:2},1024),s(te,{class:"status"},{default:r((()=>[c(f(t.status),1)])),_:2},1024)])),_:2},1024),"h5"==e.$store.state.device_type&&!t.status&&["mv","add","sub"].includes(t.FOpType)?(u(),m(J,{key:0},{default:r((()=>[s(W,{type:"trash",size:"24",color:"#dd524d",onClick:e=>E.submit_delete(t),class:"uni-ml-5"},null,8,["onClick"])])),_:2},1024)):n("",!0)])),_:2},1024)])),_:2},1032,["disabled"])])),_:2},1032,["right-options","onClick"])))),128))])),_:1},512)])),_:1},8,["sub-title"])):n("",!0),D.material.material_no?(u(),m(X,{key:2,title:"库存信息",type:"square",class:"above-uni-goods-nav"},{right:r((()=>[s(J,{class:"uni-section__right"},{default:r((()=>[s(J,{class:"text-md text-primary",onClick:t[4]||(t[4]=e=>E.open_move_dialog(null))},{default:r((()=>[s(W,{type:"plusempty",color:"#007aff"}),c(" 新增库存 ")])),_:1})])),_:1})])),default:r((()=>[D.invs.length?(u(),m(ee,{key:0},{default:r((()=>[(u(!0),i(_,null,p(D.invs,((e,t)=>(u(),m(Z,{key:t,"extra-icon":{type:"location",size:"24"},"show-extra-icon":"",onClick:t=>E.open_move_dialog(e),clickable:"",showArrow:""},{body:r((()=>[s(J,{class:"uni-list-item__body"},{default:r((()=>[s(J,{class:"title"},{default:r((()=>[c(f(e["FStockLocId.FNumber"]),1)])),_:2},1024),s(J,{class:"note"},{default:r((()=>[s(J,null,{default:r((()=>[c("批次："+f(e.FBatchNo),1)])),_:2},1024),s(J,null,{default:r((()=>[c("供应商："+f(e["FSupplierId.FName"]),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),footer:r((()=>[s(J,{class:"uni-list-item__foot"},{default:r((()=>[s(te,{class:"op_qty"},{default:r((()=>[e.planned_qty?(u(),i(_,{key:0},[c("("+f(e.FQty-e.planned_qty)+")",1)],64)):n("",!0),c(" "+f(e.FQty)+" "+f(e["FStockUnitId.FName"]),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):(u(),m(le,{key:1,status:"nomore","content-text":{contentnomore:"没有相关数据"}}))])),_:1})):n("",!0),s(J,{class:"uni-goods-nav-wrapper"},{default:r((()=>[s(ie,{options:D.goods_nav.options,"button-group":D.goods_nav.button_group,fill:e.$store.state.goods_nav_fill,onClick:E.goods_nav_click,onButtonClick:E.goods_nav_button_click},null,8,["options","button-group","fill","onClick","onButtonClick"])])),_:1}),s(re,{ref:"search_drawer",width:e.$store.state.drawer_width},{default:r((()=>[s(se,{"scroll-y":"",style:{height:"100%"},onTouchmove:t[6]||(t[6]=h((()=>{}),["stop"]))},{default:r((()=>[s(X,{title:"搜索结果",type:"square","sub-title":"最多展示20条匹配结果"},{right:r((()=>[s(J,{class:"uni-section__right"},{default:r((()=>[s(W,{type:"closeempty",size:"24",color:"#333",onClick:t[5]||(t[5]=t=>e.$refs.search_drawer.close())})])),_:1})])),default:r((()=>[s(ee,null,{default:r((()=>[(u(!0),i(_,null,p(D.search_form.candidates,((e,t)=>(u(),m(Z,{key:t,title:e.FNumber,note:[`名称：${e.FName}`,`规格：${e.FSpecification}`].join("\n"),thumb:E.thumbnail_url(e.FImageFileServer),"thumb-size":"lg",onClick:t=>E.load_data(e.FNumber),clickable:"","show-arrow":""},null,8,["title","note","thumb","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["width"]),s(he,{ref:"move_dialog",type:"dialog"},{default:r((()=>[s(pe,{type:"error",title:"调整计划",cancelText:"关闭",confirmText:D.move_dialog.confirm_text,onClose:E.close_move_dialog,onConfirm:E.confirm_move_dialog,beforeClose:!0,style:{width:"360px"}},{default:r((()=>[s(J,{class:"move-form"},{default:r((()=>[s(me,{modelValue:D.move_form.type,"onUpdate:modelValue":t[7]||(t[7]=e=>D.move_form.type=e),localdata:[{text:"调整数量",value:"edit",disable:"new"==D.edit_mode},{text:"转移库位",value:"move",disable:"new"==D.edit_mode},{text:"新增库存",value:"new"}],class:"uni-mb-10"},null,8,["modelValue","localdata"]),s(H,{ref:"move_form",model:D.move_form,rules:D.move_form_rules},{default:r((()=>["move"==D.move_form.type?(u(),i(_,{key:0},[s(de,null,{default:r((()=>[s(ne,{span:8,class:"move-form-left"},{default:r((()=>[c(f(D.move_form.inv["FStockLocId.FNumber"]||"-"),1)])),_:1}),s(ne,{span:4,class:"move-form-center"},{default:r((()=>[s(W,{type:"redo",size:20,color:"#007bff"})])),_:1}),s(ne,{span:12,class:"move-form-right"},{default:r((()=>[s(K,{name:"dest_loc_no"},{default:r((()=>[s(_e,{modelValue:D.move_form.dest_loc_no,"onUpdate:modelValue":t[8]||(t[8]=e=>D.move_form.dest_loc_no=e),localdata:e.$store.state.stock_loc_opts,split:"-","popup-title":"请选择库位"},null,8,["modelValue","localdata"])])),_:1})])),_:1})])),_:1}),s(de,null,{default:r((()=>[s(ne,{span:8,class:"move-form-left"},{default:r((()=>[c(f(D.move_form.inv.FBatchNo||"-"),1)])),_:1}),s(ne,{span:4,class:"move-form-center"},{default:r((()=>[s(W,{type:"redo",size:20,color:"#007bff"})])),_:1}),s(ne,{span:12,class:"move-form-right"},{default:r((()=>[c(f(D.move_form.inv.FBatchNo),1)])),_:1})])),_:1}),s(de,null,{default:r((()=>[s(ne,{span:8,class:"move-form-left"},{default:r((()=>[s(te,null,{default:r((()=>[c(f(D.move_form.inv.FQty-D.move_form.inv.planned_qty||"-"),1)])),_:1}),D.move_form.op_qty?(u(),m(te,{key:0,class:"moving-qty"},{default:r((()=>[c(" - "+f(D.move_form.op_qty),1)])),_:1})):n("",!0)])),_:1}),s(ne,{span:4,class:"move-form-center"},{default:r((()=>[s(W,{type:"redo",size:20,color:"#007bff"})])),_:1}),s(ne,{span:12,class:"move-form-right"},{default:r((()=>[s(K,{name:"op_qty",style:{"padding-top":"5px","line-height":"25px"}},{label:r((()=>[s(J)])),default:r((()=>[s(ue,{modelValue:D.move_form.op_qty,"onUpdate:modelValue":t[9]||(t[9]=e=>D.move_form.op_qty=e),min:1,max:D.move_form.inv.FQty-D.move_form.inv.planned_qty,width:60},null,8,["modelValue","max"])])),_:1})])),_:1})])),_:1})],64)):n("",!0),"edit"==D.move_form.type?(u(),i(_,{key:1},[s(de,null,{default:r((()=>[s(ne,{span:8,class:"move-form-left"},{default:r((()=>[c(f(D.move_form.inv["FStockLocId.FNumber"]||"-"),1)])),_:1})])),_:1}),s(de,null,{default:r((()=>[s(ne,{span:8,class:"move-form-left"},{default:r((()=>[c(f(D.move_form.inv.FBatchNo||"-"),1)])),_:1})])),_:1}),s(de,null,{default:r((()=>[s(ne,{span:8,class:"move-form-left"},{default:r((()=>[s(te,null,{default:r((()=>[c(f(D.move_form.inv.FQty-D.move_form.inv.planned_qty),1)])),_:1}),D.move_form.edit_qty>D.move_form.inv.FQty-D.move_form.inv.planned_qty?(u(),m(te,{key:0,class:"moving-qty"},{default:r((()=>[c(" + "+f(D.move_form.edit_qty-D.move_form.inv.FQty+D.move_form.inv.planned_qty),1)])),_:1})):n("",!0),D.move_form.edit_qty<D.move_form.inv.FQty-D.move_form.inv.planned_qty?(u(),m(te,{key:1,class:"moving-qty"},{default:r((()=>[c(" - "+f(D.move_form.inv.FQty-D.move_form.inv.planned_qty-D.move_form.edit_qty),1)])),_:1})):n("",!0)])),_:1}),s(ne,{span:4,class:"move-form-center"},{default:r((()=>[s(W,{type:"redo",size:20,color:"#007bff"})])),_:1}),s(ne,{span:12,class:"move-form-right"},{default:r((()=>[s(K,{name:"edit_qty",style:{"padding-top":"5px","line-height":"25px"}},{label:r((()=>[s(J)])),default:r((()=>[s(ue,{modelValue:D.move_form.edit_qty,"onUpdate:modelValue":t[10]||(t[10]=e=>D.move_form.edit_qty=e),min:0,max:9999,width:60},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):n("",!0),"new"==D.move_form.type?(u(),i(_,{key:2},[s(de,null,{default:r((()=>[s(K,{label:"库位",name:"new_loc_no","label-width":"40px"},{default:r((()=>[s(_e,{modelValue:D.move_form.new_loc_no,"onUpdate:modelValue":t[11]||(t[11]=e=>D.move_form.new_loc_no=e),localdata:e.$store.state.stock_loc_opts,split:"-","popup-title":"请选择库位"},null,8,["modelValue","localdata"])])),_:1})])),_:1}),s(de,null,{default:r((()=>[s(K,{label:"批次",name:"new_batch_no","label-width":"40px"},{default:r((()=>[s(ce,{modelValue:D.move_form.new_batch_no,"onUpdate:modelValue":t[12]||(t[12]=e=>D.move_form.new_batch_no=e),type:"date","return-type":"string"},null,8,["modelValue"])])),_:1})])),_:1}),s(de,null,{default:r((()=>[s(K,{label:"数量",name:"new_qty","label-width":"40px"},{default:r((()=>[s(ue,{modelValue:D.move_form.new_qty,"onUpdate:modelValue":t[13]||(t[13]=e=>D.move_form.new_qty=e),min:1,max:9999,width:60,style:{"padding-top":"5px","line-height":"25px"}},null,8,["modelValue"])])),_:1})])),_:1})],64)):n("",!0),s(de,null,{default:r((()=>[s(K,{label:"备注",name:"remark","label-width":"40px",style:{"margin-bottom":"0"}},{default:r((()=>[s(Y,{modelValue:D.move_form.remark,"onUpdate:modelValue":t[14]||(t[14]=e=>D.move_form.remark=e),type:"textarea","auto-height":"",trim:"both",placeholder:"请填写调整原因"},null,8,["modelValue"]),(u(!0),i(_,null,p(D.remark_presets,((e,t)=>(u(),m(fe,{key:t,text:e,onClick:t=>E.auto_input_remark(e),type:"primary",size:"small",inverted:"",circle:"",class:"uni-mr-2"},null,8,["text","onClick"])))),128))])),_:1}),s(K,{label:"单据",name:"bill_no","label-width":"40px",style:{"margin-bottom":"0"}},{default:r((()=>[s(Y,{modelValue:D.move_form.bill_no,"onUpdate:modelValue":t[15]||(t[15]=e=>D.move_form.bill_no=e),placeholder:"单据编号"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1},8,["confirmText","onClose","onConfirm"])])),_:1},512)],64)}],["__scopeId","data-v-33dbce63"]]);export{J as default};
