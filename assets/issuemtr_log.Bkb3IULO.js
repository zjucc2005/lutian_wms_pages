var e,t=Object.defineProperty;import{s as r}from"./index-DsK9pIyj.js";import{K as a}from"./k3cloudapi.PCDjx1SF.js";class i{constructor(e={}){e.FID&&(this.FID=e.FID),this.FOpSN=r.state.snowflake.next_id(),this.FOpType=e.FOpType,this.FStockId={FStockId:e.FStockId},this.FMaterialId={FMaterialId:e.FMaterialId},e.FSupplierId&&(this.FSupplierId={FSupplierId:e.FSupplierId}),this.FOpQTY=e.FOpQTY,this.FBatchNo=e.FBatchNo,this.FBillNo=e.FBillNo||"",this.FRemark=e.FRemark||"",this.FOpStaffNo=e.FOpStaffNo}save(){const e={model:this};return a.save("PAEZ_C_ISSUEMTR_LOG",e)}cancel(e){const t={model:{FID:this.FID,FOpType:this.FOpType+"_cl",FRemark:`${(new Date).toISOString()} 被[${e}]取消`}};return a.save("PAEZ_C_ISSUEMTR_LOG",t)}static batch_save(e=[]){const t={model:e,ValidateRepeatJson:!0};return a.batch_save("PAEZ_C_ISSUEMTR_LOG",t)}static async delete(e=[]){const t={Ids:e.join(",")};return a.delete("PAEZ_C_ISSUEMTR_LOG",t)}static query(e={},t={}){const r={FormId:"PAEZ_C_ISSUEMTR_LOG",FilterString:a.query_filter(e)};return t.per_page&&(r.Limit=t.per_page,t.page&&(r.StartRow=(t.page-1)*t.per_page)),t.order&&(r.OrderString=t.order),a.bill_query(r)}static find(e){return this.query({FID:e},{limit:1})}static async summary(e={}){let t=[];return t=await this._summary_recurse(e,{page:1,per_page:1e4,order:"FCreateTime ASC"},t),t}static async _summary_recurse(e={},t={},r=[]){const i={FormId:"PAEZ_C_ISSUEMTR_LOG",FieldKeys:["FOpType","FOpQTY","FCreateTime"].join(","),FilterString:a.query_filter(e)};t.per_page&&(i.Limit=t.per_page,t.page&&(i.StartRow=(t.page-1)*t.per_page)),t.order&&(i.OrderString=t.order);let s=await a.execute_bill_query(i);return r=r.concat(s.data),s.data.length===t.per_page?(t.page+=1,this._summary_recurse(e,t,r)):r}}((e,r,a)=>{r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a})(i,"symbol"!=typeof(e="FOpTypeEnum")?e+"":e,{send:"发料",receive:"用料"});export{i as I};
