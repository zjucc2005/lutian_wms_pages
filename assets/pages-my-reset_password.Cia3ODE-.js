import{s as e,b as o,R as s,c as r,d as a,w as t,o as i,e as m,f as l,l as n,i as d}from"./index-Bu7BB2Sn.js";import{_ as u}from"./uni-easyinput.rEyKZ7UZ.js";import{r as p}from"./uni-app.es.DqvpptM9.js";import{_ as f,a as _}from"./uni-forms.k46PHGUU.js";import{_ as c}from"./uni-section.CtzwYLr2.js";import{B as h}from"./bd_empinfo.CoBO88he.js";import"./k3cloudapi.cCLE6bXq.js";import"./stock_loc.Bg1Allw4.js";import"./inv_log.CiTZZpLf.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.BaZHZ2F1.js";const b=w({data(){return{empinfo:{},form:{old_password:"",password:"",password_confirmation:""},form_rules:{old_password:{rules:[{required:!0,errorMessage:"请填写原密码"},{validateFunction:(e,o,s,r)=>this.empinfo.WMSPWD&&o!=this.empinfo.WMSPWD?r("原密码错误"):this.empinfo.WMSPWD||o==this.empinfo.Number?void 0:r("原密码错误")}]},password:{rules:[{required:!0,errorMessage:"请填写新密码"},{minLength:6,maxLength:16,errorMessage:"密码长度在 {minLength} 到 {maxLength} 个字符"}]},password_confirmation:{rules:[{required:!0,errorMessage:"请填写密码确认"},{validateFunction:(e,o,s,r)=>{if(o!=this.form.password)return r("密码确认和新密码不一致")}}]}}}},mounted(){h.view(e.state.cur_staff.FNumber).then((e=>{var o,s;this.empinfo=(null==(s=null==(o=e.data)?void 0:o.Result)?void 0:s.Result)||{}}))},methods:{submit(){this.$refs.form.validate().then((e=>{h.update(this.empinfo.Id,{FWMSPWD:this.form.password}).then((e=>{o({title:"修改成功"}),s()}))})).catch((e=>{}))}}},[["render",function(e,o,s,h,w,b){const j=p(r("uni-easyinput"),u),g=p(r("uni-forms-item"),f),v=n,V=p(r("uni-forms"),_),y=d,M=p(r("uni-section"),c);return i(),a(M,{title:"重置密码",type:"square"},{default:t((()=>[m(y,{class:"container"},{default:t((()=>[m(V,{ref:"form",model:w.form,rules:w.form_rules,"label-width":"80px"},{default:t((()=>[m(g,{label:"原密码",name:"old_password",required:""},{default:t((()=>[m(j,{modelValue:w.form.old_password,"onUpdate:modelValue":o[0]||(o[0]=e=>w.form.old_password=e),type:"password",trim:"both"},null,8,["modelValue"])])),_:1}),m(g,{label:"新密码",name:"password",required:""},{default:t((()=>[m(j,{modelValue:w.form.password,"onUpdate:modelValue":o[1]||(o[1]=e=>w.form.password=e),type:"password",trim:"both"},null,8,["modelValue"])])),_:1}),m(g,{label:"密码确认",name:"password_confirmation",required:""},{default:t((()=>[m(j,{modelValue:w.form.password_confirmation,"onUpdate:modelValue":o[2]||(o[2]=e=>w.form.password_confirmation=e),type:"password",trim:"both"},null,8,["modelValue"])])),_:1}),m(v,{type:"primary",onClick:b.submit},{default:t((()=>[l("提交")])),_:1},8,["onClick"])])),_:1},8,["model","rules"])])),_:1})])),_:1})}]]);export{b as default};
