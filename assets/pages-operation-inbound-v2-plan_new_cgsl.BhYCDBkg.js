import{s as t,b as e,n as l,m as a,a as i,h as n,v as o,c as s,d as _,w as r,q as u,e as d,g as c,F as f,i as p,o as m,u as y,f as h,t as b,S as k,k as g,l as v,T as F}from"./index-MIvYX1nW.js";import{_ as q}from"./uni-list-item.Dk-snU2X.js";import{r as w}from"./uni-app.es.B8zr0lZI.js";import{_ as x}from"./uni-list.zX7C8YBn.js";import{_ as S}from"./uni-section.C7O4oyAr.js";import{_ as I,a as C}from"./uni-row.Cx_kdH4q.js";import{_ as N}from"./uni-steps.BbStP99S.js";import{_ as j,a as B,b as T}from"./uni-td.B3Sq6FHr.js";import{_ as M}from"./uni-easyinput.BboSH9MB.js";import{_ as V}from"./uni-tag.DOImtkHb.js";import{_ as D}from"./uni-table.CMkDOYII.js";import{_ as L}from"./uni-icons.DEYikQDp.js";import{_ as $}from"./uni-drawer.COomJS_R.js";import{_ as O}from"./uni-goods-nav.DSaXBg-u.js";import{I as A}from"./inbound_task.BSJaUx0d.js";import"./k3cloudapi.DzDu3BGl.js";import{a as U,S as z,I as Q}from"./stock_loc.BckAHwoS.js";import"./inv_log.BJcJnepW.js";import{p as R}from"./index.DbF5UMRK.js";import{_ as E}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{f as Y}from"./date-format.Dm3Q97cL.js";import"./uni-badge.DDwx_b0i.js";import"./uni-datetime-picker.D11eskE5.js";const J=E({data:()=>({inbound_task:{},invs:[],inv_plans:[],inv_plans_ex:[],inv_plans_preview:[],form:{material_id:"",base_unit_qty:0,pallet_infos:[]},op_type_dict:U.FOpTypeEnum,step_options:[{title:"选择物料"},{title:"填写托盘信息"},{title:"已分配库位"}],step_active:0,plan_form:{material_id:"",material_no:"",base_unit_name:"",decimal_unit:!1,pallet_infos:[]},goods_nav:{options:[{icon:"list",text:"物料"}],button_group:[{text:"分配库位",backgroundColor:t.state.goods_nav_color.grey,color:"#fff"}]}}),onLoad(t){this.getOpenerEventChannel().on("sendInboundTask",(t=>{t.inbound_task?this.inbound_task=t.inbound_task:this.inbound_task=A.current(),this.load_data()}))},mounted(){z.query({FStockId:t.state.cur_stock.FStockId,FForbidStatus:"B"}).then((e=>{t.commit("update_stock_locs",e.data)}))},computed:{sum_qty_of_pallet_info(){let t=0;for(let e of this.form.pallet_infos)e.per_qty&&e.pallet_qty&&(t+=Number(e.per_qty)*Number(e.pallet_qty));return t},sum_pallet_qty(){let t=0;for(let e of this.form.pallet_infos)e.per_qty&&e.pallet_qty&&(t+=Number(e.pallet_qty));return t}},methods:{formatDate:Y,select_material(t){var e;for(let l of this.inbound_task.inbound_list)l.selected=!1;t.selected=!0,this.init_form(t),null==(e=this.$refs.material_drawer)||e.close()},init_form(t){this.init_pallet_infos(t),this.form.material_id=t.material_id,this.form.base_unit_qty=t.base_unit_qty,this.inv_plans.some((e=>e.FMaterialId===t.material_id))?this.activate_step(2):this.activate_step(1)},init_pallet_infos(t){let e=this.planned_qty(t.material_id),l=t.base_unit_qty-e;if(l&&t.plt_std_qty){let e=[],a=Math.floor(l/t.plt_std_qty),i=l-t.plt_std_qty*a;a>0&&e.push({per_qty:t.plt_std_qty,pallet_qty:a}),i>0&&e.push({per_qty:i,pallet_qty:1}),this.form.pallet_infos=e}else this.form.pallet_infos=[{per_qty:"",pallet_qty:""}]},add_pallet_info(){this.form.pallet_infos.length>=5?e({icon:"none",title:"最多5行"}):this.form.pallet_infos.push({per_qty:"",pallet_qty:""})},del_pallet_info(t){this.form.pallet_infos.length<=1?e({icon:"none",title:"最少保留1行"}):this.form.pallet_infos.splice(t,1)},validate_pallet_info(t,l,a){let i=Number(t.detail.value);i<=0?(l[a]="",i<0&&e({icon:"none",title:"数量必须大于0"})):l[a]=i},allocate_loc_no(){let t=this.inbound_task.inbound_list.find((t=>t.material_id==this.form.material_id));this.sum_qty_of_pallet_info===t.base_unit_qty-this.planned_qty(t.material_id)?l({url:"/pages/operation/inbound/v2/allocate_loc_no",events:{allocateInfo:t=>{this.preview(t.allocate_info),this.submit_save()}},success:t=>{R("success");let e=this.get_idle_stock_locs();t.eventChannel.emit("initStockLocs",{stock_locs:e,pallet_qty:this.sum_pallet_qty})}}):e({icon:"none",title:"物料数量不一致"})},get_idle_stock_locs(){let e=[];return t.state.stock_locs.forEach((t=>{e.push({...t,idle:this.is_idle_stock_loc(t.FNumber)})})),e},is_idle_stock_loc(e){return!t.state.stock_locs.find((t=>t.FNumber==e&&"B"==t.FForbidStatus))&&(!this.invs.some((t=>t["FStockLocId.FNumber"]==e))&&!this.inv_plans.some((t=>t["FStockLocId.FNumber"]==e))&&!this.inv_plans_ex.some((t=>t["FStockLocId.FNumber"]==e)))},preview(t){let e=[],l=JSON.parse(JSON.stringify(this.form.pallet_infos));for(let a of t){let t={loc_no:a.no,qty:0,pallet_infos:[]};for(let e of l)if(e.per_qty&&e.pallet_qty)for(;e.pallet_qty>0&&t.pallet_infos.length<a.v;)e.pallet_qty-=1,t.qty+=e.per_qty,t.pallet_infos.push(e.per_qty);e.push(t)}this.inv_plans_preview=e},planned_qty(t){let e=0;for(let l of this.inv_plans)l.FMaterialId==t&&(e+=l.FOpQTY);return e},if_submit_delete(t){a({title:t?"删除":"删除全部",content:t?"是否确定删除?":"是否确定删除当前物料的全部计划明细？",success:e=>{e.confirm&&this.submit_delete(t)},fail:t=>{}})},goods_nav_click(t){0===t.index&&this.$refs.material_drawer.open()},goods_nav_button_click(t){0===this.step_active||1===this.step_active?0===t.index&&this.allocate_loc_no():2===this.step_active&&(0===t.index&&this.activate_step(1),1===t.index&&this.if_submit_delete())},activate_step(e){this.step_active=e,0===e?this.goods_nav.button_group=[{text:"分配库位",backgroundColor:t.state.goods_nav_color.grey,color:"#fff"}]:1===e?this.goods_nav.button_group=[{text:"分配库位",backgroundColor:t.state.goods_nav_color.blue,color:"#fff"}]:2===e&&(this.goods_nav.button_group=[{text:"上一步",backgroundColor:t.state.goods_nav_color.grey,color:"#fff"},{text:"删除全部计划",backgroundColor:t.state.goods_nav_color.red,color:"#fff"}])},async load_data(){await this.load_invs(),await this.load_inv_plans(),await this.load_inv_plans_ex(),this.inbound_task.inbound_list.length&&this.select_material(this.inbound_task.inbound_list[0])},async load_invs(){let e={FStockId:t.state.cur_stock.FStockId};return i({title:"Loading"}),Q.get_all(e,{order:"FMaterialId.FNumber ASC, FStockLocId.FNumber ASC"}).then((t=>{this.$logger.info(">>> 加载库存，完毕"),n(),this.invs=t}))},async load_inv_plans(){return i({title:"Loading"}),U.query({FStockId:t.state.cur_stock.FStockId,FBillNo:this.inbound_task.bill_no,FOpType:"in"},{order:"FCreateTime ASC"}).then((e=>{this.$logger.info(">>> 加载当前入库计划，完毕"),n(),this.inv_plans=e.data,this.inv_plans.forEach((e=>{"A"!=e.FDocumentStatu&&(e.status=t.state.document_status_dict[e.FDocumentStatu])}))}))},async load_inv_plans_ex(){return i({title:"Loading"}),U.query({FStockId:t.state.cur_stock.FStockId,FBillNo_ne:this.inbound_task.bill_no,FOpType:"in",FDocumentStatu_in:["A","B"]},{order:"FCreateTime ASC"}).then((t=>{this.$logger.info(">>> 加载其余入库计划，完毕"),n(),this.inv_plans_ex=t.data}))},async submit_save(){i({title:"Loading",mask:!0});let e=this.inbound_task.inbound_list.find((t=>t.material_id==this.form.material_id));for(let l of this.inv_plans_preview){let a=new U({FOpType:"in",FStockId:t.state.cur_stock.FStockId,FStockLocNo:l.loc_no,FMaterialId:e.material_id,FOpQTY:1*l.qty,FBatchNo:e.batch_no,FSupplierId:e.supplier_id,FBillNo:this.inbound_task.bill_no,FOpStaffNo:t.state.cur_staff.FNumber,FRemark:l.pallet_infos.join(","),FPalletQty:l.pallet_infos.length});await a.save()}n(),R("success"),await this.load_inv_plans(),this.activate_step(2),o({scrollTop:0})},async submit_delete(t){var l;let a=[];if(a=t?this.inv_plans.filter((e=>e.FID===t&&"A"==e.FDocumentStatu)):this.inv_plans.filter((t=>t.FMaterialId===this.form.material_id&&"A"==t.FDocumentStatu)),a.some((t=>"A"!=t.FDocumentStatu)))return void e({icon:"none",title:"不能删除"});i({title:"Loading",mask:!0});let o=await U.delete(a.map((t=>t.FID)));n(),o.data.Result.ResponseStatus.IsSuccess?(R("delete"),await this.load_inv_plans(),this.init_form(this.form)):e({icon:"none",title:null==(l=o.data.Result.ResponseStatus.Errors[0])?void 0:l.Message})}}},[["render",function(t,e,l,a,i,n){const o=p,A=w(s("uni-list-item"),q),U=w(s("uni-list"),x),z=w(s("uni-section"),S),Q=w(s("uni-col"),I),R=w(s("uni-steps"),N),E=w(s("uni-th"),j),Y=w(s("uni-tr"),B),J=w(s("uni-easyinput"),M),P=w(s("uni-td"),T),G=w(s("uni-tag"),V),K=g,W=w(s("uni-table"),D),H=v,X=w(s("uni-row"),C),Z=w(s("uni-icons"),L),tt=F,et=w(s("uni-drawer"),$),lt=w(s("uni-goods-nav"),O);return"h5"===t.$store.state.screen_type?(m(),_(X,{key:0,gutter:10},{default:r((()=>[d(Q,{span:6,style:{position:"relative","border-right":"2px solid #ccc","overflow-y":"scroll"}},{default:r((()=>[d(z,{title:"入库物料明细",type:"square","sub-title":"选择物料","sub-title-color":"#007aff",onClick:e[0]||(e[0]=e=>console.log(">> $data",t.$data))},{default:r((()=>[d(U,null,{default:r((()=>[(m(!0),u(f,null,y(i.inbound_task.inbound_list,((t,e)=>(m(),_(A,{key:e,"show-extra-icon":!0,"extra-icon":{type:t.selected?"circle-filled":"circle",size:"24",color:t.selected?"#007bff":"#999999"},onClick:e=>n.select_material(t),clickable:"","show-arrow":""},{body:r((()=>[d(o,{class:"uni-list-item__body"},{default:r((()=>[d(o,{class:"title"},{default:r((()=>[h(b(t.material_no),1)])),_:2},1024),d(o,{class:"note"},{default:r((()=>[d(o,null,{default:r((()=>[h("名称："+b(t.material_name),1)])),_:2},1024),d(o,null,{default:r((()=>[h("规格："+b(t.material_spec),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),footer:r((()=>[d(o,{class:"uni-list-item__foot"},{default:r((()=>[d(o,null,{default:r((()=>[h(b(t.base_unit_qty)+" "+b(t.base_unit_name),1)])),_:2},1024),i.inv_plans.some((e=>e.FMaterialId===t.material_id))?(m(),_(o,{key:0,class:"text-primary"},{default:r((()=>[h("已计划 "+b(n.planned_qty(t.material_id)),1)])),_:2},1024)):c("",!0)])),_:2},1024)])),_:2},1032,["extra-icon","onClick"])))),128))])),_:1})])),_:1})])),_:1}),d(Q,{span:18},{default:r((()=>[d(z,{title:"新增计划明细",type:"square","sub-title":i.inbound_task.bill_no,"sub-title-color":"#007aff"},{default:r((()=>[d(R,{options:i.step_options,active:i.step_active,class:"uni-mt-5 uni-mb-5"},null,8,["options","active"])])),_:1},8,["sub-title"]),n.planned_qty(i.form.material_id)<i.form.base_unit_qty?(m(),_(z,{key:0,title:"填写托盘信息",type:"square","sub-title":"‌‌总和 = ∑ (每托数量 x 托数)"},{default:r((()=>[d(o,{class:"container"},{default:r((()=>[d(W,{ref:"pallet_infos",border:"",stripe:"",class:"pallet-infos"},{default:r((()=>[d(Y,null,{default:r((()=>[d(E,{align:"center"},{default:r((()=>[h("每托数量")])),_:1}),d(E,{align:"center"},{default:r((()=>[h("托数")])),_:1}),d(E,{align:"center"},{default:r((()=>[h("小计")])),_:1}),d(E,{align:"center"},{default:r((()=>[h("操作")])),_:1})])),_:1}),(m(!0),u(f,null,y(i.form.pallet_infos,((t,e)=>(m(),_(Y,{key:e},{default:r((()=>[d(P,{align:"center"},{default:r((()=>[d(J,{type:"number",clearable:!1,"input-border":!1,modelValue:t.per_qty,"onUpdate:modelValue":e=>t.per_qty=e,onBlur:e=>n.validate_pallet_info(e,t,"per_qty"),style:{"text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","onBlur"])])),_:2},1024),d(P,{align:"center"},{default:r((()=>[d(J,{type:"number",clearable:!1,"input-border":!1,modelValue:t.pallet_qty,"onUpdate:modelValue":e=>t.pallet_qty=e,onBlur:e=>n.validate_pallet_info(e,t,"pallet_qty"),style:{"text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","onBlur"])])),_:2},1024),d(P,{align:"center"},{default:r((()=>[h(b(t.per_qty*t.pallet_qty),1)])),_:2},1024),d(P,{align:"center"},{default:r((()=>[d(G,{text:"删除行",type:i.form.pallet_infos.length>1?"error":"default",onClick:t=>n.del_pallet_info(e)},null,8,["type","onClick"])])),_:2},1024)])),_:2},1024)))),128)),d(Y,null,{default:r((()=>[d(P,{align:"center"},{default:r((()=>[d(K,{class:"text-bold"},{default:r((()=>[h("总计")])),_:1})])),_:1}),d(P,{align:"center"},{default:r((()=>[h(b(n.sum_pallet_qty),1)])),_:1}),d(P,{align:"center"},{default:r((()=>[h(b(n.sum_qty_of_pallet_info),1)])),_:1}),d(P,{align:"center"},{default:r((()=>[d(G,{text:"新增行",type:i.form.pallet_infos.length<5?"primary":"default",onClick:n.add_pallet_info},null,8,["type","onClick"])])),_:1})])),_:1})])),_:1},512),d(o,{class:"btn-wrapper"},{default:r((()=>[d(H,{type:"primary",size:"mini",onClick:n.allocate_loc_no},{default:r((()=>[h("分配库位")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})):c("",!0),i.inv_plans.filter((t=>t.FMaterialId===i.form.material_id)).length?(m(),_(z,{key:1,title:"当前计划明细",type:"square"},{default:r((()=>[d(o,{class:"container"},{default:r((()=>[d(W,{border:"",stripe:""},{default:r((()=>[d(Y,null,{default:r((()=>[d(E,{align:"center",width:"60"},{default:r((()=>[h("序号")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("操作类型")])),_:1}),d(E,{align:"center",width:"60"},{default:r((()=>[h("数量")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("单位")])),_:1}),d(E,{align:"center",width:"120"},{default:r((()=>[h("库位")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("批次")])),_:1}),d(E,{align:"center"},{default:r((()=>[h("供应商")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("状态")])),_:1}),d(E,{align:"center",width:"160"},{default:r((()=>[h("时间")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("操作")])),_:1})])),_:1}),(m(!0),u(f,null,y(i.inv_plans.filter((t=>t.FMaterialId===i.form.material_id)),((e,l)=>(m(),_(Y,{key:l},{default:r((()=>[d(P,{align:"center"},{default:r((()=>[h(b(l+1),1)])),_:2},1024),d(P,null,{default:r((()=>[h(b(i.op_type_dict[e.FOpType]),1)])),_:2},1024),d(P,null,{default:r((()=>[h(b(e.FOpQTY),1)])),_:2},1024),d(P,null,{default:r((()=>[h(b(e["FStockUnitId.FName"]),1)])),_:2},1024),d(P,null,{default:r((()=>[h(b(e["FStockLocId.FNumber"]),1)])),_:2},1024),d(P,null,{default:r((()=>[h(b(e.FBatchNo),1)])),_:2},1024),d(P,null,{default:r((()=>[h(b(e["FSupplierId.FName"]),1)])),_:2},1024),d(P,null,{default:r((()=>[d(K,{class:"text-primary"},{default:r((()=>[h(b(t.$store.state.document_status_dict[e.FDocumentStatu]),1)])),_:2},1024)])),_:2},1024),d(P,null,{default:r((()=>[h(b(n.formatDate(e.FCreateTime,"yyyy-MM-dd hh:mm:ss")),1)])),_:2},1024),d(P,{align:"center"},{default:r((()=>["A"==e.FDocumentStatu?(m(),_(G,{key:0,text:"删除",type:"error",onClick:t=>n.if_submit_delete(e.FID)},null,8,["onClick"])):c("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),d(o,{class:"btn-wrapper"},{default:r((()=>[d(H,{type:"warn",size:"mini",onClick:e[1]||(e[1]=t=>n.if_submit_delete())},{default:r((()=>[h("删除全部")])),_:1})])),_:1})])),_:1})])),_:1})):c("",!0)])),_:1})])),_:1})):(m(),u(f,{key:1},[d(et,{ref:"material_drawer",width:t.$store.state.drawer_width},{default:r((()=>[d(tt,{"scroll-y":"",style:{height:"100%"},onTouchmove:e[3]||(e[3]=k((()=>{}),["stop"]))},{default:r((()=>[d(z,{title:"入库物明细",type:"square","sub-title":"选择物料"},{right:r((()=>[d(o,{class:"uni-section__right"},{default:r((()=>[d(Z,{type:"closeempty",size:"20",color:"#333",onClick:e[2]||(e[2]=e=>t.$refs.material_drawer.close())})])),_:1})])),default:r((()=>[d(U,null,{default:r((()=>[(m(!0),u(f,null,y(i.inbound_task.inbound_list,((t,e)=>(m(),_(A,{key:e,"show-extra-icon":!0,"extra-icon":{type:t.selected?"circle-filled":"circle",size:"24",color:t.selected?"#007bff":"#999999"},onClick:e=>n.select_material(t),clickable:"","show-arrow":""},{body:r((()=>[d(o,{class:"uni-list-item__body"},{default:r((()=>[d(o,{class:"title"},{default:r((()=>[h(b(t.material_no),1)])),_:2},1024),d(o,{class:"note"},{default:r((()=>[d(o,null,{default:r((()=>[h("名称："+b(t.material_name),1)])),_:2},1024),d(o,null,{default:r((()=>[h("规格："+b(t.material_spec),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),footer:r((()=>[d(o,{class:"uni-list-item__foot"},{default:r((()=>[d(o,null,{default:r((()=>[h(b(t.base_unit_qty)+" "+b(t.base_unit_name),1)])),_:2},1024),i.inv_plans.some((e=>e.FMaterialId===t.material_id))?(m(),_(o,{key:0,class:"text-primary"},{default:r((()=>[h("已计划 "+b(n.planned_qty(t.material_id)),1)])),_:2},1024)):c("",!0)])),_:2},1024)])),_:2},1032,["extra-icon","onClick"])))),128))])),_:1})])),_:1})])),_:1})])),_:1},8,["width"]),d(z,{title:"新增计划明细",type:"square","sub-title":i.inbound_task.bill_no,"sub-title-color":"#007aff"},{default:r((()=>[d(R,{options:i.step_options,active:i.step_active,class:"uni-mt-5 uni-mb-5"},null,8,["options","active"]),i.form.material_id?(m(),_(U,{key:0},{default:r((()=>[(m(!0),u(f,null,y(i.inbound_task.inbound_list,((l,a)=>(m(),u(f,{key:a},[l.selected?(m(),_(A,{key:0,"show-extra-icon":!0,"extra-icon":{type:l.selected?"circle-filled":"circle",size:"24",color:l.selected?"#007bff":"#999999"},onClick:e[4]||(e[4]=e=>t.$refs.material_drawer.open()),clickable:"","show-arrow":""},{body:r((()=>[d(o,{class:"uni-list-item__body"},{default:r((()=>[d(o,{class:"title"},{default:r((()=>[h(b(l.material_no),1)])),_:2},1024),d(o,{class:"note"},{default:r((()=>[d(o,null,{default:r((()=>[h("名称："+b(l.material_name),1)])),_:2},1024),d(o,null,{default:r((()=>[h("规格："+b(l.material_spec),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),footer:r((()=>[d(o,{class:"uni-list-item__foot"},{default:r((()=>[d(o,null,{default:r((()=>[h(b(l.base_unit_qty)+" "+b(l.base_unit_name),1)])),_:2},1024),i.inv_plans.some((t=>t.FMaterialId===l.material_id))?(m(),_(o,{key:0,class:"text-primary"},{default:r((()=>[h("已计划 "+b(n.planned_qty(l.material_id)),1)])),_:2},1024)):c("",!0)])),_:2},1024)])),_:2},1032,["extra-icon"])):c("",!0)],64)))),128))])),_:1})):c("",!0)])),_:1},8,["sub-title"]),1===i.step_active?(m(),_(z,{key:0,title:"填写托盘信息",type:"square","sub-title":"‌‌总和 = ∑ (每托数量 x 托数)"},{default:r((()=>[d(o,{class:"container"},{default:r((()=>[d(W,{ref:"pallet_infos",border:"",stripe:"",class:"pallet-infos"},{default:r((()=>[d(Y,null,{default:r((()=>[d(E,{align:"center",width:"100"},{default:r((()=>[h("每托数量")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("托数")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("小计")])),_:1}),d(E,{align:"center",width:"80"},{default:r((()=>[h("操作")])),_:1})])),_:1}),(m(!0),u(f,null,y(i.form.pallet_infos,((t,e)=>(m(),_(Y,{key:e},{default:r((()=>[d(P,{align:"center"},{default:r((()=>[d(J,{type:"number",clearable:!1,"input-border":!1,modelValue:t.per_qty,"onUpdate:modelValue":e=>t.per_qty=e,onBlur:e=>n.validate_pallet_info(e,t,"per_qty"),style:{"text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","onBlur"])])),_:2},1024),d(P,{align:"center"},{default:r((()=>[d(J,{type:"number",clearable:!1,"input-border":!1,modelValue:t.pallet_qty,"onUpdate:modelValue":e=>t.pallet_qty=e,onBlur:e=>n.validate_pallet_info(e,t,"pallet_qty"),style:{"text-align":"center"}},null,8,["modelValue","onUpdate:modelValue","onBlur"])])),_:2},1024),d(P,{align:"center"},{default:r((()=>[h(b(t.per_qty*t.pallet_qty),1)])),_:2},1024),d(P,{align:"center"},{default:r((()=>[d(G,{text:"删除行",type:i.form.pallet_infos.length>1?"error":"default",onClick:t=>n.del_pallet_info(e)},null,8,["type","onClick"])])),_:2},1024)])),_:2},1024)))),128)),d(Y,null,{default:r((()=>[d(P,{align:"center"},{default:r((()=>[d(K,{class:"text-bold"},{default:r((()=>[h("总计")])),_:1})])),_:1}),d(P,{align:"center"},{default:r((()=>[h(b(n.sum_pallet_qty),1)])),_:1}),d(P,{align:"center"},{default:r((()=>[h(b(n.sum_qty_of_pallet_info),1)])),_:1}),d(P,{align:"center"},{default:r((()=>[d(G,{text:"新增行",type:i.form.pallet_infos.length<5?"primary":"default",onClick:n.add_pallet_info},null,8,["type","onClick"])])),_:1})])),_:1})])),_:1},512)])),_:1})])),_:1})):c("",!0),i.inv_plans.filter((t=>t.FMaterialId===i.form.material_id)).length?(m(),_(z,{key:1,title:"当前计划明细",type:"square",class:"above-uni-goods-nav"},{default:r((()=>[d(U,null,{default:r((()=>[(m(!0),u(f,null,y(i.inv_plans.filter((t=>t.FMaterialId===i.form.material_id)),((e,l)=>(m(),_(A,{key:l,"show-extra-icon":!0,"extra-icon":{type:"arrow-up",size:"24",color:"#dd524d"},onClick:t=>n.if_submit_delete(e.FID),clickable:"","show-arrow":""},{body:r((()=>[d(o,{class:"uni-list-item__body"},{default:r((()=>[d(o,{class:"title"},{default:r((()=>[h(b(e["FStockLocId.FNumber"]),1)])),_:2},1024),d(o,{class:"note"},{default:r((()=>[d(o,null,{default:r((()=>[h("批次："+b(e.FBatchNo),1)])),_:2},1024),d(o,null,{default:r((()=>[h("供应商："+b(e["FSupplierId.FName"]),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),footer:r((()=>[d(o,{class:"uni-list-item__foot"},{default:r((()=>[d(K,{class:"op_qty"},{default:r((()=>[h(b(e.FOpQTY)+" "+b(e["FStockUnitId.FName"]),1)])),_:2},1024),d(K,{class:"status"},{default:r((()=>[h(b(t.$store.state.document_status_dict[e.FDocumentStatu]),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):c("",!0),d(o,{class:"uni-goods-nav-wrapper"},{default:r((()=>[d(lt,{options:i.goods_nav.options,"button-group":i.goods_nav.button_group,fill:t.$store.state.goods_nav_fill,onClick:n.goods_nav_click,onButtonClick:n.goods_nav_button_click},null,8,["options","button-group","fill","onClick","onButtonClick"])])),_:1})],64))}],["__scopeId","data-v-106446d3"]]);export{J as default};
