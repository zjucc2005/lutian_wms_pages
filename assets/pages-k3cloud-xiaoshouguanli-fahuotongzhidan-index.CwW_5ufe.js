import{P as e,s as t,v as a,c as o,q as s,d as l,w as i,e as r,F as _,o as d,u as n,C as c,i as m,f as u,t as f,L as h}from"./index-MIvYX1nW.js";import{_ as p}from"./uni-table.CMkDOYII.js";import{r as g}from"./uni-app.es.B8zr0lZI.js";import{_ as y}from"./uni-list-item.Dk-snU2X.js";import{_ as v}from"./uni-list.zX7C8YBn.js";import{_ as b}from"./uni-load-more.5aGCwx5G.js";import{_ as x}from"./uni-fab.CC_INFyt.js";import{_ as j}from"./uni-datetime-picker.D11eskE5.js";import{_ as F,a as k}from"./uni-forms.C-YkALHf.js";import{_ as w,a as C}from"./uni-row.Cx_kdH4q.js";import{_ as D}from"./uni-easyinput.BboSH9MB.js";import{_ as V}from"./uni-data-select.7wY52LM_.js";import{_ as I,a as P}from"./uni-popup.j9WTBudP.js";import{t as $,l as S}from"./index.DbF5UMRK.js";import"./k3cloudapi.DzDu3BGl.js";import"./stock_loc.BckAHwoS.js";import"./inv_log.BJcJnepW.js";import{S as T}from"./sal_delivery_notice.CMiyKXvU.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{f as A}from"./date-format.Dm3Q97cL.js";import"./uni-icons.DEYikQDp.js";import"./uni-badge.DDwx_b0i.js";const B=U({data:()=>({delivery_notices:[],search_form:{date:"",bill_no:"",receiver:"",close_status:""},page:1,per_page:100,load_more_status:"more",fab_content:[{iconPath:"/static/icon/cc_search.png",selectedIconPath:"/static/icon/cc_search_active.png",text:"搜索",active:!1},{iconPath:"/static/icon/cc_gotop.png",selectedIconPath:"/static/icon/cc_gotop_active.png",text:"返回顶部",active:!1}]}),onPullDownRefresh(){this.reload_delivery_notices(),e()},onReachBottom(){this.load_more()},mounted(){this.load_delivery_notices()},methods:{truncate:$,formatDate:A,async load_delivery_notices(){let e={FDocumentStatus:"C",FDeliveryOrgId:t.state.cur_stock.FUseOrgId},a={page:this.page,per_page:this.per_page,order:"FID DESC"};this.search_form.date&&(e.FDate_ge=this.search_form.date[0],e.FDate_le=this.search_form.date[1]),this.search_form.bill_no&&(e.FBillNo_lk=this.search_form.bill_no),this.search_form.receiver&&(e.F_PAEZ_Text_lk=this.search_form.receiver),this.search_form.close_status&&(e.FCloseStatus=this.search_form.close_status),this.load_more_status="loading",T.query(e,a).then((e=>{this.load_more_status=e.data.length<this.per_page?"nomore":"more",e.data.forEach((e=>this.delivery_notices.push(e)))}))},reload_delivery_notices(){this.delivery_notices=[],this.load_more_status="more",this.page=1,this.load_delivery_notices()},fab_trigger(e){0===e.index&&this.$refs.search_dialog.open(),1===e.index&&a({scrollTop:0})},load_more(){"nomore"!=this.load_more_status&&(this.page+=1,this.load_delivery_notices())},search_dialog_close(){console.log("this.$data",this.$data),this.$refs.search_dialog.close()},search_dialog_confirm(){this.reload_delivery_notices(),this.search_dialog_close()},show_delivery_notice(e){S("/pages/k3cloud/xiaoshouguanli/fahuotongzhidan/show?id="+e)}}},[["render",function(e,t,a,$,S,T){const U=g(o("uni-table"),p),A=m,B=g(o("uni-list-item"),y),E=g(o("uni-list"),v),M=g(o("uni-load-more"),b),L=g(o("uni-fab"),x),O=g(o("uni-datetime-picker"),j),W=g(o("uni-forms-item"),F),N=g(o("uni-col"),w),R=g(o("uni-easyinput"),D),q=g(o("uni-data-select"),V),Z=g(o("uni-row"),C),z=g(o("uni-forms"),k),G=g(o("uni-popup-dialog"),I),J=g(o("uni-popup"),P);return d(),s(_,null,[e.$store.state.system_info.windowWidth>=12e3?(d(),l(U,{key:0,ref:"table",border:"",stripe:""},null,512)):(d(),l(E,{key:1},{default:i((()=>[(d(!0),s(_,null,n(S.delivery_notices,((t,a)=>(d(),l(B,{key:a,onClick:e=>T.show_delivery_notice(t.FID),clickable:"","show-arrow":""},{body:i((()=>[r(A,{class:"uni-list-item__body"},{default:i((()=>[r(A,{class:"title"},{default:i((()=>[u(f(t.FBillNo),1)])),_:2},1024),r(A,{class:"note"},{default:i((()=>[r(A,null,{default:i((()=>[u("发货组织："+f(t["FDeliveryOrgId.FName"]),1)])),_:2},1024),r(A,null,{default:i((()=>[u("收货人："+f(t.F_PAEZ_Text),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),footer:i((()=>[r(A,{class:"uni-list-item__foot"},{default:i((()=>[r(A,null,{default:i((()=>[u(f(T.formatDate(t.FDate,"yyyy-MM-dd")),1)])),_:2},1024),r(A,{class:h("A"==t.FCloseStatus?"text-primary":"")},{default:i((()=>[u(f(e.$store.state.close_status_dict[t.FCloseStatus]),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})),r(M,{status:S.load_more_status,onClickLoadMore:T.load_more},null,8,["status","onClickLoadMore"]),r(L,{ref:"fab",content:S.fab_content,onTrigger:T.fab_trigger,show:""},null,8,["content","onTrigger"]),r(J,{ref:"search_dialog",type:"dialog"},{default:i((()=>[r(G,{type:"info",title:"搜索条件",cancelText:"关闭",onClose:T.search_dialog_close,onConfirm:T.search_dialog_confirm,"before-close":!0,style:c({width:e.$store.state.system_info.windowWidth-20+"px",minWidth:"360px",maxWidth:"1200px"})},{default:i((()=>[r(A,{class:"search-form"},{default:i((()=>[r(z,{ref:"search_form",model:S.search_form,"label-width":100},{default:i((()=>[r(Z,{gutter:15},{default:i((()=>[r(N,{md:8,sm:12,xs:24},{default:i((()=>[r(W,{label:"日期"},{default:i((()=>[r(O,{modelValue:S.search_form.date,"onUpdate:modelValue":t[0]||(t[0]=e=>S.search_form.date=e),type:"daterange","start-placeholder":"开始","end-placeholder":"结束"},null,8,["modelValue"])])),_:1})])),_:1}),r(N,{md:8,sm:12,xs:24},{default:i((()=>[r(W,{label:"单据编号"},{default:i((()=>[r(R,{modelValue:S.search_form.bill_no,"onUpdate:modelValue":t[1]||(t[1]=e=>S.search_form.bill_no=e)},null,8,["modelValue"])])),_:1})])),_:1}),r(N,{md:8,sm:12,xs:24},{default:i((()=>[r(W,{label:"收货人"},{default:i((()=>[r(R,{modelValue:S.search_form.receiver,"onUpdate:modelValue":t[2]||(t[2]=e=>S.search_form.receiver=e)},null,8,["modelValue"])])),_:1})])),_:1}),r(N,{md:8,sm:12,xs:24},{default:i((()=>[r(W,{label:"关闭状态"},{default:i((()=>[r(q,{modelValue:S.search_form.close_status,"onUpdate:modelValue":t[3]||(t[3]=e=>S.search_form.close_status=e),localdata:[{value:"A",text:"未关闭"},{value:"B",text:"关闭"}]},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})])),_:1},8,["onClose","onConfirm","style"])])),_:1},512)],64)}],["__scopeId","data-v-d4a6fc60"]]);export{B as default};
