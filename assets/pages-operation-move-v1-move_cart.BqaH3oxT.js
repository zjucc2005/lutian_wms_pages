import{s as t,p as o,G as s,m as i,b as e,a,h as n,c as r,d as c,w as _,i as l,o as u,e as m,q as f,u as d,F as v,f as p,t as g,k as h}from"./index-DWoH3vfe.js";import{_ as b}from"./uni-icons.Btv09wDc.js";import{r as k}from"./uni-app.es.BmoqNwAf.js";import{_ as F}from"./uni-list-item.DDtNoANW.js";import{_ as j}from"./uni-list.BUls3DLZ.js";import{_ as x}from"./uni-goods-nav.CFHsP2dB.js";import{p as y}from"./index.CbUtXxpp.js";import{M as C}from"./move_cart.Cfij9s3Q.js";import"./k3cloudapi.RL4SGN7f.js";import"./stock_loc.DkKMhjD6.js";import"./inv_log.B23E6Sfg.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-badge.Dyjwvs1c.js";const w=I({data:()=>({cur_staff:{},move_cart:{move_list:[]},goods_nav:{options:[{icon:"cart",text:"计划",info:0}],button_group:[{text:"清空计划",backgroundColor:"linear-gradient(90deg, #AAA, #606266)",color:"#fff"},{text:"提交计划",backgroundColor:"linear-gradient(90deg, #1E83FF, #0053B8)",color:"#fff"}]}}),mounted(){this.cur_staff=t.state.cur_staff,this.move_cart=C.current(),this.refresh_cart_info()},methods:{goods_nav_click(t){0==t.index&&this.$logger.info("move_cart",this.move_cart)},goods_nav_button_click(t){0==t.index&&this.if_clear_cart(),1==t.index&&this.if_submit_move()},if_clear_cart(){o({itemList:["清空计划"],success:t=>{0===t.tapIndex&&this.clear_cart()}})},clear_cart(){let t=new C(this.move_cart);this.move_cart=t.destroy(),this.refresh_cart_info(),s("syncMoveCart",{msg:"sync_move_cart"})},if_submit_move(){this.move_cart.move_list.length?i({title:"提交计划注意事项",content:"请仔细核对库存调整信息，提交计划后，将会更新库存数据。",success:t=>{t.confirm&&this.submit_move()},fail:t=>{}}):e({icon:"none",title:"计划为空"})},async submit_move(){try{y("success"),a({title:"Loading"});let t=new C(this.move_cart);await t.exec({staff_no:this.cur_staff.FNumber}),e({title:"提交成功"}),this.move_cart=C.current(),this.refresh_cart_info(),s("syncMoveCart",{msg:"sync_move_cart"})}catch(t){n()}},refresh_cart_info(){let t=0;this.move_cart.move_list.map((o=>t+=o.qty)),this.goods_nav.options[0].info=t}}},[["render",function(t,o,s,i,e,a){const n=h,y=l,C=k(r("uni-icons"),b),I=k(r("uni-list-item"),F),w=k(r("uni-list"),j),M=k(r("uni-goods-nav"),x);return u(),c(y,null,{default:_((()=>[m(w,null,{default:_((()=>[(u(!0),f(v,null,d(e.move_cart.move_list,((t,o)=>(u(),c(I,{key:o,rightText:[t.qty,t.inv["FStockUnitId.FName"]].join(" ")},{body:_((()=>[m(y,{class:"uni-list-item__content uni-list-item__content--center"},{default:_((()=>[m(n,{class:"uni-list-item__content-title"},{default:_((()=>[p(g(t.inv["FMaterialId.FNumber"]),1)])),_:2},1024),m(y,{class:"uni-list-item__content-note"},{default:_((()=>[m(y,null,{default:_((()=>[p(g(t.inv["FMaterialId.FName"]),1)])),_:2},1024),m(y,null,{default:_((()=>[p(g(t.inv["FMaterialId.FSpecification"]),1)])),_:2},1024),m(y,null,{default:_((()=>[p(" 库位号："+g(t.inv["FStockLocId.FNumber"])+" ",1),m(C,{type:"redo",color:"#007bff"}),m(n,{class:"new_loc_no"},{default:_((()=>[p(g(t.loc_no),1)])),_:2},1024)])),_:2},1024),m(y,null,{default:_((()=>[p(" 批次号："),m(n,{class:"batch_no"},{default:_((()=>[p(g(t.inv.FBatchNo),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["rightText"])))),128))])),_:1}),m(y,{class:"uni-goods-nav-wrapper"},{default:_((()=>[m(M,{options:e.goods_nav.options,"button-group":e.goods_nav.button_group,onClick:a.goods_nav_click,onButtonClick:a.goods_nav_button_click},null,8,["options","button-group","onClick","onButtonClick"])])),_:1})])),_:1})}],["__scopeId","data-v-fd66ee2a"]]);export{w as default};
