import{o as e,d as t,w as a,a8 as i,L as h,C as d,D as s,q as n,t as l,g as r,i as c}from"./index-Bu7BB2Sn.js";import{_ as o}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=o({name:"uniTable",options:{virtualHost:!0},emits:["selection-change"],props:{data:{type:Array,default:()=>[]},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1},type:{type:String,default:""},emptyText:{type:String,default:"没有更多数据"},loading:{type:Boolean,default:!1},rowKey:{type:String,default:""}},data:()=>({noData:!0,minWidth:0,multiTableHeads:[]}),watch:{loading(e){},data(e){this.theadChildren,this.theadChildren&&this.theadChildren.rowspan,this.noData=!1}},created(){this.trChildren=[],this.thChildren=[],this.theadChildren=null,this.backData=[],this.backIndexData=[]},methods:{isNodata(){this.theadChildren;let e=1;this.theadChildren&&(e=this.theadChildren.rowspan),this.noData=this.trChildren.length-e<=0},selectionAll(){let e=1,t=this.theadChildren;this.theadChildren?e=t.rowspan-1:t=this.trChildren[0];let a=this.data&&this.data.length>0;t.checked=!0,t.indeterminate=!1,this.trChildren.forEach(((t,i)=>{if(!t.disabled){if(t.checked=!0,a&&t.keyValue){const e=this.data.find((e=>e[this.rowKey]===t.keyValue));this.backData.find((t=>t[this.rowKey]===e[this.rowKey]))||this.backData.push(e)}i>e-1&&-1===this.backIndexData.indexOf(i-e)&&this.backIndexData.push(i-e)}})),this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})},toggleRowSelection(e,t){e=[].concat(e),this.trChildren.forEach(((a,i)=>{const h=e.findIndex((e=>"number"==typeof e?e===i-1:e[this.rowKey]===a.keyValue));let d=a.checked;-1!==h&&(a.checked="boolean"==typeof t?t:!a.checked,d!==a.checked&&this.check(a.rowData||a,a.checked,a.rowData?a.keyValue:null,!0))})),this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})},clearSelection(){let e=this.theadChildren;this.theadChildren||(e=this.trChildren[0]),e.checked=!1,e.indeterminate=!1,this.trChildren.forEach((e=>{e.checked=!1})),this.backData=[],this.backIndexData=[],this.$emit("selection-change",{detail:{value:[],index:[]}})},toggleAllSelection(){let e=[],t=1,a=this.theadChildren;this.theadChildren?t=a.rowspan-1:a=this.trChildren[0],this.trChildren.forEach(((a,i)=>{a.disabled||i>t-1&&e.push(i-t)})),this.toggleRowSelection(e)},check(e,t,a,i){let h=this.theadChildren;this.theadChildren||(h=this.trChildren[0]);let d=this.trChildren.findIndex(((t,a)=>e===t));if(d<0&&(d=this.data.findIndex((e=>e[this.rowKey]===a))+1),this.trChildren.filter((e=>!e.disabled&&e.keyValue)).length,0===d)return void(t?this.selectionAll():this.clearSelection());if(t)a&&this.backData.push(e),this.backIndexData.push(d-1);else{const e=this.backData.findIndex((e=>e[this.rowKey]===a)),t=this.backIndexData.findIndex((e=>e===d-1));a&&this.backData.splice(e,1),this.backIndexData.splice(t,1)}this.trChildren.find(((e,t)=>t>0&&!e.checked&&!e.disabled))?(h.indeterminate=!0,h.checked=!1):(h.indeterminate=!1,h.checked=!0),0===this.backIndexData.length&&(h.indeterminate=!1),i||this.$emit("selection-change",{detail:{value:this.backData,index:this.backIndexData}})}}},[["render",function(o,b,k,p,u,f){const y=c;return e(),t(y,{class:h(["uni-table-scroll",{"table--border":k.border,"border-none":!u.noData}])},{default:a((()=>[i("table",{class:h(["uni-table",{"table--stripe":k.stripe}]),border:"0",cellpadding:"0",cellspacing:"0",style:d({"min-width":u.minWidth+"px"})},[s(o.$slots,"default",{},void 0,!0),u.noData?(e(),n("tr",{key:0,class:"uni-table-loading"},[i("td",{class:h(["uni-table-text",{"empty-border":k.border}])},l(k.emptyText),3)])):r("",!0),k.loading?(e(),t(y,{key:1,class:h(["uni-table-mask",{"empty-border":k.border}])},{default:a((()=>[i("div",{class:"uni-table--loader"})])),_:1},8,["class"])):r("",!0)],6)])),_:3},8,["class"])}],["__scopeId","data-v-82f3199e"]]);export{b as _};
